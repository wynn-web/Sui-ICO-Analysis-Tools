<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customized Randomized Sensitivity Simulation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            padding: 20px;
            max-width: 900px;
            margin: 0 auto;
            background-color: #f4f7f9;
            color: #333;
        }
        .container {
            background: #fff;
            padding: 20px 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .input-group {
            margin-bottom: 10px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        .input-group input {
            width: 90%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 12px;
            font-size: 18px;
            color: #fff;
            background-color: #3498db;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 20px;
        }
        .btn:hover {
            background-color: #2980b9;
        }
        .results-section {
            margin-top: 30px;
            padding: 20px;
            background-color: #e8f4f8;
            border-left: 5px solid #3498db;
            border-radius: 5px;
        }
        .results-section h2 {
            margin-top: 0;
        }
        .results-section p {
            font-size: 16px;
        }
        .highlight {
            font-weight: 700;
            color: #2ecc71;
        }
        .warning {
            font-weight: 700;
            color: #e74c3c;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Customized Randomized Sensitivity Simulation</h1>
        <p>Set the min and max ranges for your variables and run a simulation to determine which variable is more impactful on profitability.</p>

        <h2>Simulation Parameters</h2>
        <div class="input-grid">
            <div>
                <h3>Baseline Projects</h3>
                <div class="input-group">
                    <label for="baseProjectsMin">Min:</label>
                    <input type="number" id="baseProjectsMin" value="5">
                </div>
                <div class="input-group">
                    <label for="baseProjectsMax">Max:</label>
                    <input type="number" id="baseProjectsMax" value="20">
                </div>
            </div>
            <div>
                <h3>Number of BDs</h3>
                <div class="input-group">
                    <label for="bdCountMin">Min:</label>
                    <input type="number" id="bdCountMin" value="1">
                </div>
                <div class="input-group">
                    <label for="bdCountMax">Max:</label>
                    <input type="number" id="bdCountMax" value="5">
                </div>
            </div>
            <div>
                <h3>BD Monthly Project KPI</h3>
                <div class="input-group">
                    <label for="bdKpiMin">Min:</label>
                    <input type="number" id="bdKpiMin" value="1">
                </div>
                <div class="input-group">
                    <label for="bdKpiMax">Max:</label>
                    <input type="number" id="bdKpiMax" value="5">
                </div>
            </div>
            <div>
                <h3>Users per Project</h3>
                <div class="input-group">
                    <label for="usersMin">Min:</label>
                    <input type="number" id="usersMin" value="50">
                </div>
                <div class="input-group">
                    <label for="usersMax">Max:</label>
                    <input type="number" id="usersMax" value="900">
                </div>
            </div>
            <div>
                <h3>Purchases per User</h3>
                <div class="input-group">
                    <label for="purchasesPerUserMin">Min:</label>
                    <input type="number" id="purchasesPerUserMin" value="1">
                </div>
                <div class="input-group">
                    <label for="purchasesPerUserMax">Max:</label>
                    <input type="number" id="purchasesPerUserMax" value="5">
                </div>
            </div>
            <div>
                <h3>Claims per User</h3>
                <div class="input-group">
                    <label for="claimsPerUserMin">Min:</label>
                    <input type="number" id="claimsPerUserMin" value="1">
                </div>
                <div class="input-group">
                    <label for="claimsPerUserMax">Max:</label>
                    <input type="number" id="claimsPerUserMax" value="10">
                </div>
            </div>
            <div>
                <h3>Funds Raised per Project</h3>
                <div class="input-group">
                    <label for="fundsRaisedMin">Min:</label>
                    <input type="number" id="fundsRaisedMin" value="500">
                </div>
                <div class="input-group">
                    <label for="fundsRaisedMax">Max:</label>
                    <input type="number" id="fundsRaisedMax" value="500000">
                </div>
            </div>
            <div>
                <h3>Platform Fee (%)</h3>
                <div class="input-group">
                    <label for="platformFeeMin">Min:</label>
                    <input type="number" id="platformFeeMin" value="1">
                </div>
                <div class="input-group">
                    <label for="platformFeeMax">Max:</label>
                    <input type="number" id="platformFeeMax" value="10">
                </div>
            </div>
            <div>
                <h3>Fixed Cost (USD)</h3>
                <div class="input-group">
                    <label for="fixedCostMin">Min:</label>
                    <input type="number" id="fixedCostMin" value="1000">
                </div>
                <div class="input-group">
                    <label for="fixedCostMax">Max:</label>
                    <input type="number" id="fixedCostMax" value="10000">
                </div>
            </div>
            <div>
                <h3>Total Project Market Cap</h3>
                <div class="input-group">
                    <label for="marketCapMin">Min:</label>
                    <input type="number" id="marketCapMin" value="50">
                </div>
                <div class="input-group">
                    <label for="marketCapMax">Max:</label>
                    <input type="number" id="marketCapMax" value="100">
                </div>
            </div>
            <div>
                <h3>Simulation Settings</h3>
                <div class="input-group">
                    <label for="numSimulations">Number of Simulations:</label>
                    <input type="number" id="numSimulations" value="100000">
                </div>
            </div>
        </div>

        <button class="btn" onclick="runSimulation()">Run Simulation</button>

        <div id="results" class="results-section" style="display: none;">
            <h2>Simulation Results</h2>
            <p id="totalSimulations"></p>
            <p><strong>Total Projects</strong> was the more profitable strategy in: <span id="projectsCount" class="highlight">0</span> scenarios.</p>
            <p><strong>Users per Project</strong> was the more profitable strategy in: <span id="usersCount" class="highlight">0</span> scenarios.</p>
            <p><strong>Avg. Contribution per User</strong> was the more profitable strategy in: <span id="avgContributionCount" class="highlight">0</span> scenarios.</p>
            <p>They were of equal importance in: <span id="equalCount" class="highlight">0</span> scenarios.</p>
            <h3 id="finalConclusion"></h3>
            <p id="insightSummary"></p>
        </div>
    </div>

    <script>
        function runSimulation() {
            const PURCHASE_FEE_USD = 0.6;
            const CLAIM_FEE_USD = 0.6;
            const BD_SALARY_YEARLY = 2000 * 12;

            const numSimulations = parseInt(document.getElementById('numSimulations').value);
            const baseProjectsMin = parseFloat(document.getElementById('baseProjectsMin').value);
            const baseProjectsMax = parseFloat(document.getElementById('baseProjectsMax').value);
            const bdCountMin = parseFloat(document.getElementById('bdCountMin').value);
            const bdCountMax = parseFloat(document.getElementById('bdCountMax').value);
            const bdKpiMin = parseFloat(document.getElementById('bdKpiMin').value);
            const bdKpiMax = parseFloat(document.getElementById('bdKpiMax').value);
            const usersMin = parseFloat(document.getElementById('usersMin').value);
            const usersMax = parseFloat(document.getElementById('usersMax').value);
            const purchasesPerUserMin = parseFloat(document.getElementById('purchasesPerUserMin').value);
            const purchasesPerUserMax = parseFloat(document.getElementById('purchasesPerUserMax').value);
            const claimsPerUserMin = parseFloat(document.getElementById('claimsPerUserMin').value);
            const claimsPerUserMax = parseFloat(document.getElementById('claimsPerUserMax').value);
            const fundsRaisedMin = parseFloat(document.getElementById('fundsRaisedMin').value);
            const fundsRaisedMax = parseFloat(document.getElementById('fundsRaisedMax').value);
            const platformFeeMin = parseFloat(document.getElementById('platformFeeMin').value);
            const platformFeeMax = parseFloat(document.getElementById('platformFeeMax').value);
            const fixedCostMin = parseFloat(document.getElementById('fixedCostMin').value);
            const fixedCostMax = parseFloat(document.getElementById('fixedCostMax').value);
            const marketCapMin = parseFloat(document.getElementById('marketCapMin').value);
            const marketCapMax = parseFloat(document.getElementById('marketCapMax').value);
            const changeFactor = 1.2;

            let projectsWinCount = 0;
            let usersWinCount = 0;
            let avgContributionWinCount = 0;
            let equalCount = 0;

            const resultsElement = document.getElementById('results');
            const totalSimulationsElement = document.getElementById('totalSimulations');
            const projectsCountElement = document.getElementById('projectsCount');
            const usersCountElement = document.getElementById('usersCount');
            const avgContributionCountElement = document.getElementById('avgContributionCount');
            const equalCountElement = document.getElementById('equalCount');
            const finalConclusionElement = document.getElementById('finalConclusion');
            const insightSummaryElement = document.getElementById('insightSummary');

            resultsElement.style.display = 'block';
            totalSimulationsElement.textContent = `Running ${numSimulations.toLocaleString()} simulations...`;

            for (let i = 0; i < numSimulations; i++) {
                const baseProjects = getRandomInt(baseProjectsMin, baseProjectsMax);
                const bdCount = getRandomInt(bdCountMin, bdCountMax);
                const bdKpi = getRandomInt(bdKpiMin, bdKpiMax);
                const users = getRandomInt(usersMin, usersMax);
                const purchasesPerUser = getRandomInt(purchasesPerUserMin, purchasesPerUserMax);
                const claimsPerUser = getRandomInt(claimsPerUserMin, claimsPerUserMax);
                const fundsRaised = getRandom(fundsRaisedMin, fundsRaisedMax);
                const platformFeePct = getRandom(platformFeeMin, platformFeeMax);
                const fixedCost = getRandom(fixedCostMin, fixedCostMax);
                const marketCap = getRandom(marketCapMin, marketCapMax);

                const bdProjectsFromTeam = bdCount * bdKpi * 12;
                const totalProjects = Math.min(baseProjects + bdProjectsFromTeam, marketCap);
                const avgContribution = fundsRaised / users;

                const baseProfit = calculateProfit(totalProjects, users, fundsRaised, bdKpi, fixedCost, platformFeePct, purchasesPerUser, claimsPerUser, baseProjects);

                if (baseProfit <= 0) {
                    continue;
                }

                const newProjects = Math.min(totalProjects * changeFactor, marketCap);
                const newUsers = users * changeFactor;
                const newFundsRaisedFromUsers = newUsers * avgContribution;
                const newAvgContribution = avgContribution * changeFactor;
                const newFundsRaisedFromAvgContribution = newAvgContribution * users;
                
                const profitProjects = calculateProfit(newProjects, users, fundsRaised, bdKpi, fixedCost, platformFeePct, purchasesPerUser, claimsPerUser, baseProjects);
                const profitUsers = calculateProfit(totalProjects, newUsers, newFundsRaisedFromUsers, bdKpi, fixedCost, platformFeePct, purchasesPerUser, claimsPerUser, baseProjects);
                const profitAvgContribution = calculateProfit(totalProjects, users, newFundsRaisedFromAvgContribution, bdKpi, fixedCost, platformFeePct, purchasesPerUser, claimsPerUser, baseProjects);

                const growthProjects = (profitProjects - baseProfit) / baseProfit;
                const growthUsers = (profitUsers - baseProfit) / baseProfit;
                const growthAvgContribution = (profitAvgContribution - baseProfit) / baseProfit;
                
                const growths = [
                    { name: 'projects', growth: growthProjects },
                    { name: 'users', growth: growthUsers },
                    { name: 'avgContribution', growth: growthAvgContribution }
                ];
                
                let maxGrowth = -Infinity;
                let winners = [];
                for(let j=0; j<growths.length; j++) {
                    if (growths[j].growth > maxGrowth) {
                        maxGrowth = growths[j].growth;
                        winners = [growths[j].name];
                    } else if (Math.abs(growths[j].growth - maxGrowth) < 0.0001) {
                        winners.push(growths[j].name);
                    }
                }

                if (winners.includes('projects') && winners.length === 1) {
                    projectsWinCount++;
                } else if (winners.includes('users') && winners.length === 1) {
                    usersWinCount++;
                } else if (winners.includes('avgContribution') && winners.length === 1) {
                    avgContributionWinCount++;
                } else {
                    equalCount++;
                }
            }

            totalSimulationsElement.textContent = `Completed ${numSimulations.toLocaleString()} scenarios.`;
            projectsCountElement.textContent = projectsWinCount.toLocaleString();
            usersCountElement.textContent = usersWinCount.toLocaleString();
            avgContributionCountElement.textContent = avgContributionCount.toLocaleString();
            equalCountElement.textContent = equalCount.toLocaleString();

            const total = projectsWinCount + usersWinCount + avgContributionCount + equalCount;
            let conclusionText = "";
            let insightText = "";

            if (projectsWinCount / total > 0.4) {
                 conclusionText = "Conclusion: Based on a wide range of scenarios, focusing on **Total Projects** is generally the more profitable strategy.";
                 insightText = "This result is likely due to the BD team's efficiency (high KPI) and a large market cap, making each new project a significant revenue driver that easily covers the stepped costs.";
            } else if (usersWinCount / total > 0.4) {
                 conclusionText = "Conclusion: Based on a wide range of scenarios, focusing on **Users per Project** is generally the more profitable strategy.";
                 insightText = "This result suggests that fixed user fees (purchase and claim) are the dominant revenue streams, making a larger user base per project the key to profitability.";
            } else if (avgContributionCount / total > 0.4) {
                 conclusionText = "Conclusion: Based on a wide range of scenarios, focusing on **Avg. Contribution per User** is generally the more profitable strategy.";
                 insightText = "This result indicates that the platform's percentage fee on funds raised is the most significant revenue driver, making higher user contributions the most effective lever.";
            } else {
                 conclusionText = "Conclusion: The optimal strategy depends heavily on specific market conditions. All three variables have a significant impact.";
                 insightText = "This suggests a well-balanced business model. You should carefully analyze current market conditions and choose the strategy that is easiest and most cost-effective to implement.";
            }

            finalConclusionElement.textContent = conclusionText;
            finalConclusionElement.classList.add('highlight');
            insightSummaryElement.textContent = insightText;
        }

        function calculateProfit(totalProjects, users, fundsRaised, bdKpi, fixedCost, platformFeePct, purchasesPerUser, claimsPerUser, baseProjects) {
            const PURCHASE_FEE_USD = 0.6;
            const CLAIM_FEE_USD = 0.6;
            const BD_SALARY_YEARLY = 2000 * 12;

            const platformRevenue = (totalProjects * fundsRaised * (platformFeePct / 100));
            const purchaseFeeRevenue = (totalProjects * users * purchasesPerUser * PURCHASE_FEE_USD);
            const claimFeeRevenue = (totalProjects * users * claimsPerUser * CLAIM_FEE_USD);
            const totalRevenue = platformRevenue + purchaseFeeRevenue + claimFeeRevenue;
            
            const bdProjects = totalProjects - baseProjects;
            const bdCountNeeded = bdProjects > 0 ? Math.ceil(bdProjects / (bdKpi * 12)) : 0;
            const bdCost = bdCountNeeded * BD_SALARY_YEARLY;
            const totalCost = fixedCost + bdCost;
            return totalRevenue - totalCost;
        }

        function getRandom(min, max) {
            return Math.random() * (max - min) + min;
        }

        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
    </script>
</body>
</html>
